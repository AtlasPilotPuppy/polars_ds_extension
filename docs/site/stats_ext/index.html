
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../num_ext/">
      
      
        <link rel="next" href="../str_ext/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.2">
    
    
      
        <title>Stats Extension - Polars-ds Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.50c56a3b.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#extension-for-statistical-tests-and-samples" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Polars-ds Docs" class="md-header__button md-logo" aria-label="Polars-ds Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Polars-ds Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Stats Extension
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Polars-ds Docs" class="md-nav__button md-logo" aria-label="Polars-ds Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Polars-ds Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../complex_ext/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Complex Extension
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../num_ext/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Numerical Extension
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Stats Extension
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Stats Extension
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#extension-for-statistical-tests-and-samples" class="md-nav__link">
    <span class="md-ellipsis">
      Extension for Statistical Tests and Samples
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#polars_ds.stats_ext" class="md-nav__link">
    <span class="md-ellipsis">
      stats_ext
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt" class="md-nav__link">
    <span class="md-ellipsis">
      StatsExt
    </span>
  </a>
  
    <nav class="md-nav" aria-label="StatsExt">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.f_stats" class="md-nav__link">
    <span class="md-ellipsis">
      f_stats()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="f_stats()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.f_stats--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.f_test" class="md-nav__link">
    <span class="md-ellipsis">
      f_test()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="f_test()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.f_test--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.ks_binary_classif" class="md-nav__link">
    <span class="md-ellipsis">
      ks_binary_classif()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ks_binary_classif()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.ks_binary_classif--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.ks_stats" class="md-nav__link">
    <span class="md-ellipsis">
      ks_stats()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ks_stats()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.ks_stats--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.normal_test" class="md-nav__link">
    <span class="md-ellipsis">
      normal_test()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="normal_test()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.normal_test--references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.rand_int" class="md-nav__link">
    <span class="md-ellipsis">
      rand_int()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="rand_int()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.rand_int--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.rand_str" class="md-nav__link">
    <span class="md-ellipsis">
      rand_str()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="rand_str()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.rand_str--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.sample_binomial" class="md-nav__link">
    <span class="md-ellipsis">
      sample_binomial()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="sample_binomial()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.sample_binomial--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.sample_exp" class="md-nav__link">
    <span class="md-ellipsis">
      sample_exp()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="sample_exp()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.sample_exp--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.sample_normal" class="md-nav__link">
    <span class="md-ellipsis">
      sample_normal()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="sample_normal()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.sample_normal--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.sample_uniform" class="md-nav__link">
    <span class="md-ellipsis">
      sample_uniform()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="sample_uniform()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.sample_uniform--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.ttest_1samp" class="md-nav__link">
    <span class="md-ellipsis">
      ttest_1samp()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ttest_1samp()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.ttest_1samp--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.ttest_ind" class="md-nav__link">
    <span class="md-ellipsis">
      ttest_ind()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ttest_ind()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.ttest_ind--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../str_ext/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    String Extension
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#extension-for-statistical-tests-and-samples" class="md-nav__link">
    <span class="md-ellipsis">
      Extension for Statistical Tests and Samples
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#polars_ds.stats_ext" class="md-nav__link">
    <span class="md-ellipsis">
      stats_ext
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt" class="md-nav__link">
    <span class="md-ellipsis">
      StatsExt
    </span>
  </a>
  
    <nav class="md-nav" aria-label="StatsExt">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.f_stats" class="md-nav__link">
    <span class="md-ellipsis">
      f_stats()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="f_stats()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.f_stats--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.f_test" class="md-nav__link">
    <span class="md-ellipsis">
      f_test()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="f_test()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.f_test--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.ks_binary_classif" class="md-nav__link">
    <span class="md-ellipsis">
      ks_binary_classif()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ks_binary_classif()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.ks_binary_classif--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.ks_stats" class="md-nav__link">
    <span class="md-ellipsis">
      ks_stats()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ks_stats()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.ks_stats--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.normal_test" class="md-nav__link">
    <span class="md-ellipsis">
      normal_test()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="normal_test()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.normal_test--references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.rand_int" class="md-nav__link">
    <span class="md-ellipsis">
      rand_int()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="rand_int()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.rand_int--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.rand_str" class="md-nav__link">
    <span class="md-ellipsis">
      rand_str()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="rand_str()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.rand_str--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.sample_binomial" class="md-nav__link">
    <span class="md-ellipsis">
      sample_binomial()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="sample_binomial()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.sample_binomial--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.sample_exp" class="md-nav__link">
    <span class="md-ellipsis">
      sample_exp()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="sample_exp()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.sample_exp--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.sample_normal" class="md-nav__link">
    <span class="md-ellipsis">
      sample_normal()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="sample_normal()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.sample_normal--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.sample_uniform" class="md-nav__link">
    <span class="md-ellipsis">
      sample_uniform()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="sample_uniform()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.sample_uniform--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.ttest_1samp" class="md-nav__link">
    <span class="md-ellipsis">
      ttest_1samp()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ttest_1samp()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.ttest_1samp--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.ttest_ind" class="md-nav__link">
    <span class="md-ellipsis">
      ttest_ind()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ttest_ind()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#polars_ds.stats_ext.StatsExt.ttest_ind--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Stats Extension</h1>

<h2 id="extension-for-statistical-tests-and-samples">Extension for Statistical Tests and Samples</h2>


<div class="doc doc-object doc-module">



<a id="polars_ds.stats_ext"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h2 id="polars_ds.stats_ext.StatsExt" class="doc doc-heading">
          <code>StatsExt</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>This class contains tools for dealing with well-known statistical tests and random sampling inside Polars DataFrame.</p>
<p>Polars Namespace: stats_ext</p>
<p>Example: pl.col("a").stats_ext.ttest_ind(pl.col("b"), equal_var = True)</p>

            <details class="quote">
              <summary>Source code in <code>polars_ds/stats_ext.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pl</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">register_expr_namespace</span><span class="p">(</span><span class="s2">&quot;stats_ext&quot;</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">StatsExt</span><span class="p">:</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class contains tools for dealing with well-known statistical tests and random sampling inside Polars DataFrame.</span>

<span class="sd">    Polars Namespace: stats_ext</span>

<span class="sd">    Example: pl.col(&quot;a&quot;).stats_ext.ttest_ind(pl.col(&quot;b&quot;), equal_var = True)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span> <span class="o">=</span> <span class="n">expr</span>

    <span class="k">def</span> <span class="nf">ttest_ind</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">,</span> <span class="n">alternative</span><span class="p">:</span> <span class="n">Alternative</span> <span class="o">=</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">,</span> <span class="n">equal_var</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Performs 2 sample student&#39;s t test or Welch&#39;s t test. Functionality-wise this is</span>
<span class="sd">        equivalent to SciPy&#39;s ttest_ind, with fewer options. The result is not exact but</span>
<span class="sd">        within 1e-10 precision from SciPy&#39;s result.</span>

<span class="sd">        In the case of student&#39;s t test, the data is assumed to have no nulls, and n = self._expr.count()</span>
<span class="sd">        is used to compute the statistic. Note self._expr.count() only counts non-null elements after polars 0.20.</span>
<span class="sd">        The df will be 2n - 2. As a result, nulls might cause problems.</span>

<span class="sd">        In the case of Welch&#39;s t test, data will be sanitized (nulls, NaNs, Infs will be dropped</span>
<span class="sd">        before the test), and df will be counted based on the length of sanitized data.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other</span>
<span class="sd">            The other expression</span>
<span class="sd">        alternative</span>
<span class="sd">            One of &quot;two-sided&quot;, &quot;less&quot; or &quot;greater&quot;</span>
<span class="sd">        equal_var</span>
<span class="sd">            If true, perform standard student t 2 sample test. Otherwise, perform Welch&#39;s</span>
<span class="sd">            t test.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">equal_var</span><span class="p">:</span>
            <span class="n">m1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="n">m2</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="n">v1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
            <span class="n">v2</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
            <span class="n">cnt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">UInt64</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">m1</span><span class="o">.</span><span class="n">register_plugin</span><span class="p">(</span>
                <span class="n">lib</span><span class="o">=</span><span class="n">_lib</span><span class="p">,</span>
                <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;pl_ttest_2samp&quot;</span><span class="p">,</span>
                <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">m2</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">cnt</span><span class="p">,</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">alternative</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Utf8</span><span class="p">)],</span>
                <span class="n">is_elementwise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">returns_scalar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">s1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">is_finite</span><span class="p">())</span>
            <span class="n">s2</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">is_finite</span><span class="p">())</span>
            <span class="n">m1</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="n">m2</span> <span class="o">=</span> <span class="n">s2</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="n">v1</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
            <span class="n">v2</span> <span class="o">=</span> <span class="n">s2</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
            <span class="n">n1</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">UInt64</span><span class="p">)</span>
            <span class="n">n2</span> <span class="o">=</span> <span class="n">s2</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">UInt64</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">m1</span><span class="o">.</span><span class="n">register_plugin</span><span class="p">(</span>
                <span class="n">lib</span><span class="o">=</span><span class="n">_lib</span><span class="p">,</span>
                <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;pl_welch_t&quot;</span><span class="p">,</span>
                <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">m2</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">alternative</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Utf8</span><span class="p">)],</span>
                <span class="n">is_elementwise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">returns_scalar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">ttest_1samp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop_mean</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">alternative</span><span class="p">:</span> <span class="n">Alternative</span> <span class="o">=</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Performs a standard 1 sample t test using reference column and expected mean. This function</span>
<span class="sd">        sanitizes the self column first. The df is the count of valid values.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pop_mean</span>
<span class="sd">            The expected population mean in the hypothesis test</span>
<span class="sd">        alternative</span>
<span class="sd">            One of &quot;two-sided&quot;, &quot;less&quot; or &quot;greater&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">s1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">is_finite</span><span class="p">())</span>
        <span class="n">sm</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">pm</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">pop_mean</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Float64</span><span class="p">)</span>
        <span class="n">var</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
        <span class="n">cnt</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">UInt64</span><span class="p">)</span>
        <span class="n">alt</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">alternative</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Utf8</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">sm</span><span class="o">.</span><span class="n">register_plugin</span><span class="p">(</span>
            <span class="n">lib</span><span class="o">=</span><span class="n">_lib</span><span class="p">,</span>
            <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;pl_ttest_1samp&quot;</span><span class="p">,</span>
            <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">pm</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">cnt</span><span class="p">,</span> <span class="n">alt</span><span class="p">],</span>
            <span class="n">is_elementwise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">returns_scalar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">f_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">cols</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes multiple F statistics at once using self as the grouping column. This does not</span>
<span class="sd">        output p values. If the p value is desired, use f_test. This will return</span>
<span class="sd">        all the stats as a scalar list in order.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *cols</span>
<span class="sd">            Polars expressions for numerical columns. The columns must be of the same length.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">register_plugin</span><span class="p">(</span>
            <span class="n">lib</span><span class="o">=</span><span class="n">_lib</span><span class="p">,</span>
            <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;pl_f_stats&quot;</span><span class="p">,</span>
            <span class="n">args</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">cols</span><span class="p">),</span>
            <span class="n">is_elementwise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">returns_scalar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">f_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Performs the ANOVA F-test using self as the grouping column.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other</span>
<span class="sd">            The column to run ANOVA F-test on</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">register_plugin</span><span class="p">(</span>
            <span class="n">lib</span><span class="o">=</span><span class="n">_lib</span><span class="p">,</span>
            <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;pl_f_test&quot;</span><span class="p">,</span>
            <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">other</span><span class="p">],</span>
            <span class="n">is_elementwise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">returns_scalar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">normal_test</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Perform a normality test which is based on D&#39;Agostino and Pearson&#39;s test</span>
<span class="sd">        that combines skew and kurtosis to produce an omnibus test of normality.</span>
<span class="sd">        Null values, NaN and inf are dropped when running this computation.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        D&#39;Agostino, R. B. (1971), &quot;An omnibus test of normality for</span>
<span class="sd">            moderate and large sample size&quot;, Biometrika, 58, 341-348</span>
<span class="sd">        D&#39;Agostino, R. and Pearson, E. S. (1973), &quot;Tests for departure from</span>
<span class="sd">            normality&quot;, Biometrika, 60, 613-622</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">valid</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">is_finite</span><span class="p">())</span>
        <span class="n">skew</span> <span class="o">=</span> <span class="n">valid</span><span class="o">.</span><span class="n">skew</span><span class="p">()</span>
        <span class="c1"># Pearson Kurtosis, see here: https://en.wikipedia.org/wiki/D%27Agostino%27s_K-squared_test</span>
        <span class="n">kur</span> <span class="o">=</span> <span class="n">valid</span><span class="o">.</span><span class="n">kurtosis</span><span class="p">(</span><span class="n">fisher</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">skew</span><span class="o">.</span><span class="n">register_plugin</span><span class="p">(</span>
            <span class="n">lib</span><span class="o">=</span><span class="n">_lib</span><span class="p">,</span>
            <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;pl_normal_test&quot;</span><span class="p">,</span>
            <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">kur</span><span class="p">,</span> <span class="n">valid</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">UInt64</span><span class="p">)],</span>
            <span class="n">is_elementwise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">returns_scalar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">ks_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes two-sided KS statistics with other. Currently it only returns the statistics.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other</span>
<span class="sd">            A Polars Expression</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Float64</span><span class="p">)</span>
        <span class="n">other_</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Float64</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">y</span><span class="o">.</span><span class="n">register_plugin</span><span class="p">(</span>
            <span class="n">lib</span><span class="o">=</span><span class="n">_lib</span><span class="p">,</span>
            <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;pl_ks_2samp&quot;</span><span class="p">,</span>
            <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">other_</span><span class="p">,</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Boolean</span><span class="p">)],</span>
            <span class="n">is_elementwise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">returns_scalar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">ks_binary_classif</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Given a binary target, compute the ks statistics by comparing the feature where target = 1</span>
<span class="sd">        with the same feature where target != 1.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other</span>
<span class="sd">            A Polars Expression</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Float64</span><span class="p">)</span>
        <span class="n">y1</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">target</span> <span class="o">==</span> <span class="n">target</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
        <span class="n">y2</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">filter</span><span class="p">((</span><span class="n">target</span> <span class="o">==</span> <span class="n">target</span><span class="o">.</span><span class="n">max</span><span class="p">())</span><span class="o">.</span><span class="n">not_</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">y1</span><span class="o">.</span><span class="n">register_plugin</span><span class="p">(</span>
            <span class="n">lib</span><span class="o">=</span><span class="n">_lib</span><span class="p">,</span>
            <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;pl_ks_2samp&quot;</span><span class="p">,</span>
            <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">y2</span><span class="p">,</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Boolean</span><span class="p">)],</span>
            <span class="n">is_elementwise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">returns_scalar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">rand_int</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">low</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">high</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
        <span class="n">respect_null</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">use_ref</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates random integers uniformly from the range [low, high). Throws an error if low == high</span>
<span class="sd">        or if low is None and high is None and use_ref_nunique == False.</span>

<span class="sd">        This treats self as the reference column.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        low</span>
<span class="sd">            Lower end of random sample. None will be replaced 0.</span>
<span class="sd">        high</span>
<span class="sd">            Higher end of random sample. None will be replaced n_unique of reference.</span>
<span class="sd">        respect_null</span>
<span class="sd">            If true, null in reference column will be null in the new column</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">low</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">high</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Either low or high must be set.&quot;</span><span class="p">)</span>

        <span class="n">lo</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Int32</span><span class="p">)</span>
        <span class="n">hi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">n_unique</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">UInt32</span><span class="p">)</span> <span class="k">if</span> <span class="n">high</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">high</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Int32</span><span class="p">)</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">respect_null</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Boolean</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">register_plugin</span><span class="p">(</span>
            <span class="n">lib</span><span class="o">=</span><span class="n">_lib</span><span class="p">,</span>
            <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;pl_rand_int&quot;</span><span class="p">,</span>
            <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">lo</span><span class="p">,</span> <span class="n">hi</span><span class="p">,</span> <span class="n">resp</span><span class="p">],</span>
            <span class="n">is_elementwise</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">returns_scalar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">sample_uniform</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">low</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">high</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">respect_null</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates self.len() many random points sampled from a uniform distribution within [low, high).</span>
<span class="sd">        This will throw an error if low == high.</span>

<span class="sd">        This treats self as the reference column.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        low</span>
<span class="sd">            Lower end of random sample. If none, use reference col&#39;s min.</span>
<span class="sd">        high</span>
<span class="sd">            Higher end of random sample. If none, use reference col&#39;s max.</span>
<span class="sd">        respect_null</span>
<span class="sd">            If true, null in reference column will be null in the new column</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">lo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="k">if</span> <span class="n">low</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Float64</span><span class="p">)</span>
        <span class="n">hi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="k">if</span> <span class="n">high</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">high</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Float64</span><span class="p">)</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">respect_null</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Boolean</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">register_plugin</span><span class="p">(</span>
            <span class="n">lib</span><span class="o">=</span><span class="n">_lib</span><span class="p">,</span>
            <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;pl_sample_uniform&quot;</span><span class="p">,</span>
            <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">lo</span><span class="p">,</span> <span class="n">hi</span><span class="p">,</span> <span class="n">resp</span><span class="p">],</span>
            <span class="n">is_elementwise</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">returns_scalar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">sample_binomial</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">respect_null</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates self.len() many random points sampled from a uniform binomial with n and p.</span>

<span class="sd">        This treats self as the reference column.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        n</span>
<span class="sd">            n in a binomial distribution</span>
<span class="sd">        p</span>
<span class="sd">            p in a binomial distribution</span>
<span class="sd">        respect_null</span>
<span class="sd">            If true, null in reference column will be null in the new column</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">nn</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">UInt64</span><span class="p">)</span>
        <span class="n">pp</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Float64</span><span class="p">)</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">respect_null</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Boolean</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">register_plugin</span><span class="p">(</span>
            <span class="n">lib</span><span class="o">=</span><span class="n">_lib</span><span class="p">,</span>
            <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;pl_sample_binomial&quot;</span><span class="p">,</span>
            <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">nn</span><span class="p">,</span> <span class="n">pp</span><span class="p">,</span> <span class="n">resp</span><span class="p">],</span>
            <span class="n">is_elementwise</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">returns_scalar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">sample_exp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lam</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">respect_null</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates self.len() many random points sampled from a exponential distribution with n and p.</span>

<span class="sd">        This treats self as the reference column.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        lam</span>
<span class="sd">            lambda in a exponential distribution. If none, it will be 1/reference col&#39;s mean. Note that if</span>
<span class="sd">            lambda &lt; 0 will throw an error and lambda = 0 will only return infinity.</span>
<span class="sd">        respect_null</span>
<span class="sd">            If true, null in reference column will be null in the new column</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">lamb</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="k">if</span> <span class="n">lam</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Float64</span><span class="p">)</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">respect_null</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Boolean</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">register_plugin</span><span class="p">(</span>
            <span class="n">lib</span><span class="o">=</span><span class="n">_lib</span><span class="p">,</span>
            <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;pl_sample_exp&quot;</span><span class="p">,</span>
            <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">lamb</span><span class="p">,</span> <span class="n">resp</span><span class="p">],</span>
            <span class="n">is_elementwise</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">returns_scalar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">sample_normal</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">std</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">respect_null</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates self.len() many random points sampled from a normal distribution with the given</span>
<span class="sd">        mean and std.</span>

<span class="sd">        This treats self as the reference column.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mean</span>
<span class="sd">            Mean of the normal distribution. If none, use reference col&#39;s mean.</span>
<span class="sd">        std</span>
<span class="sd">            Std of the normal distribution. If none, use reference col&#39;s std.</span>
<span class="sd">        respect_null</span>
<span class="sd">            If true, null in reference column will be null in the new column</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">me</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="k">if</span> <span class="n">mean</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Float64</span><span class="p">)</span>
        <span class="n">st</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="k">if</span> <span class="n">std</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">std</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Float64</span><span class="p">)</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">respect_null</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Boolean</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">register_plugin</span><span class="p">(</span>
            <span class="n">lib</span><span class="o">=</span><span class="n">_lib</span><span class="p">,</span>
            <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;pl_sample_normal&quot;</span><span class="p">,</span>
            <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">me</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span> <span class="n">resp</span><span class="p">],</span>
            <span class="n">is_elementwise</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">returns_scalar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">rand_str</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">min_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">max_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">respect_null</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates self.len() many random strings with alpha-numerical values. Unfortunately that</span>
<span class="sd">        means this currently only generates strings satisfying [0-9a-zA-Z]. The string&#39;s</span>
<span class="sd">        length will also be uniformly.</span>

<span class="sd">        This treats self as the reference column.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        min_size</span>
<span class="sd">            The minimum length of the string to be generated. The length of the string will be</span>
<span class="sd">            uniformly generated in [min_size, max_size), except when min_size = max_size, in</span>
<span class="sd">            which case only fixed length strings will be generated.</span>
<span class="sd">        max_size</span>
<span class="sd">            The maximum length of the string to be generated.</span>
<span class="sd">        respect_null</span>
<span class="sd">            If true, null in reference column will be null in the new column</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">max_size</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input `max_size` must be positive.&quot;</span><span class="p">)</span>

        <span class="n">min_s</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">min_size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">UInt32</span><span class="p">)</span>
        <span class="n">max_s</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">max_size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">UInt32</span><span class="p">)</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">respect_null</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Boolean</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">register_plugin</span><span class="p">(</span>
            <span class="n">lib</span><span class="o">=</span><span class="n">_lib</span><span class="p">,</span>
            <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;pl_sample_alphanumeric&quot;</span><span class="p">,</span>
            <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">min_s</span><span class="p">,</span> <span class="n">max_s</span><span class="p">,</span> <span class="n">resp</span><span class="p">],</span>
            <span class="n">is_elementwise</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">returns_scalar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="polars_ds.stats_ext.StatsExt.f_stats" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">f_stats</span><span class="p">(</span><span class="o">*</span><span class="n">cols</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Computes multiple F statistics at once using self as the grouping column. This does not
output p values. If the p value is desired, use f_test. This will return
all the stats as a scalar list in order.</p>
<h5 id="polars_ds.stats_ext.StatsExt.f_stats--parameters">Parameters</h5>
<p>*cols
    Polars expressions for numerical columns. The columns must be of the same length.</p>

          <details class="quote">
            <summary>Source code in <code>polars_ds/stats_ext.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">f_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">cols</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes multiple F statistics at once using self as the grouping column. This does not</span>
<span class="sd">    output p values. If the p value is desired, use f_test. This will return</span>
<span class="sd">    all the stats as a scalar list in order.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    *cols</span>
<span class="sd">        Polars expressions for numerical columns. The columns must be of the same length.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">register_plugin</span><span class="p">(</span>
        <span class="n">lib</span><span class="o">=</span><span class="n">_lib</span><span class="p">,</span>
        <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;pl_f_stats&quot;</span><span class="p">,</span>
        <span class="n">args</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">cols</span><span class="p">),</span>
        <span class="n">is_elementwise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">returns_scalar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="polars_ds.stats_ext.StatsExt.f_test" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">f_test</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Performs the ANOVA F-test using self as the grouping column.</p>
<h5 id="polars_ds.stats_ext.StatsExt.f_test--parameters">Parameters</h5>
<p>other
    The column to run ANOVA F-test on</p>

          <details class="quote">
            <summary>Source code in <code>polars_ds/stats_ext.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">f_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs the ANOVA F-test using self as the grouping column.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    other</span>
<span class="sd">        The column to run ANOVA F-test on</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">register_plugin</span><span class="p">(</span>
        <span class="n">lib</span><span class="o">=</span><span class="n">_lib</span><span class="p">,</span>
        <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;pl_f_test&quot;</span><span class="p">,</span>
        <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">other</span><span class="p">],</span>
        <span class="n">is_elementwise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">returns_scalar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="polars_ds.stats_ext.StatsExt.ks_binary_classif" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">ks_binary_classif</span><span class="p">(</span><span class="n">target</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Given a binary target, compute the ks statistics by comparing the feature where target = 1
with the same feature where target != 1.</p>
<h5 id="polars_ds.stats_ext.StatsExt.ks_binary_classif--parameters">Parameters</h5>
<p>other
    A Polars Expression</p>

          <details class="quote">
            <summary>Source code in <code>polars_ds/stats_ext.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">ks_binary_classif</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a binary target, compute the ks statistics by comparing the feature where target = 1</span>
<span class="sd">    with the same feature where target != 1.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    other</span>
<span class="sd">        A Polars Expression</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Float64</span><span class="p">)</span>
    <span class="n">y1</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">target</span> <span class="o">==</span> <span class="n">target</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
    <span class="n">y2</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">filter</span><span class="p">((</span><span class="n">target</span> <span class="o">==</span> <span class="n">target</span><span class="o">.</span><span class="n">max</span><span class="p">())</span><span class="o">.</span><span class="n">not_</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">y1</span><span class="o">.</span><span class="n">register_plugin</span><span class="p">(</span>
        <span class="n">lib</span><span class="o">=</span><span class="n">_lib</span><span class="p">,</span>
        <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;pl_ks_2samp&quot;</span><span class="p">,</span>
        <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">y2</span><span class="p">,</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Boolean</span><span class="p">)],</span>
        <span class="n">is_elementwise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">returns_scalar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="polars_ds.stats_ext.StatsExt.ks_stats" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">ks_stats</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Computes two-sided KS statistics with other. Currently it only returns the statistics.</p>
<h5 id="polars_ds.stats_ext.StatsExt.ks_stats--parameters">Parameters</h5>
<p>other
    A Polars Expression</p>

          <details class="quote">
            <summary>Source code in <code>polars_ds/stats_ext.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">ks_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes two-sided KS statistics with other. Currently it only returns the statistics.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    other</span>
<span class="sd">        A Polars Expression</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Float64</span><span class="p">)</span>
    <span class="n">other_</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Float64</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span><span class="o">.</span><span class="n">register_plugin</span><span class="p">(</span>
        <span class="n">lib</span><span class="o">=</span><span class="n">_lib</span><span class="p">,</span>
        <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;pl_ks_2samp&quot;</span><span class="p">,</span>
        <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">other_</span><span class="p">,</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Boolean</span><span class="p">)],</span>
        <span class="n">is_elementwise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">returns_scalar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="polars_ds.stats_ext.StatsExt.normal_test" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">normal_test</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Perform a normality test which is based on D'Agostino and Pearson's test
that combines skew and kurtosis to produce an omnibus test of normality.
Null values, NaN and inf are dropped when running this computation.</p>
<h5 id="polars_ds.stats_ext.StatsExt.normal_test--references">References</h5>
<p>D'Agostino, R. B. (1971), "An omnibus test of normality for
    moderate and large sample size", Biometrika, 58, 341-348
D'Agostino, R. and Pearson, E. S. (1973), "Tests for departure from
    normality", Biometrika, 60, 613-622</p>

          <details class="quote">
            <summary>Source code in <code>polars_ds/stats_ext.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">normal_test</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform a normality test which is based on D&#39;Agostino and Pearson&#39;s test</span>
<span class="sd">    that combines skew and kurtosis to produce an omnibus test of normality.</span>
<span class="sd">    Null values, NaN and inf are dropped when running this computation.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    D&#39;Agostino, R. B. (1971), &quot;An omnibus test of normality for</span>
<span class="sd">        moderate and large sample size&quot;, Biometrika, 58, 341-348</span>
<span class="sd">    D&#39;Agostino, R. and Pearson, E. S. (1973), &quot;Tests for departure from</span>
<span class="sd">        normality&quot;, Biometrika, 60, 613-622</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">valid</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">is_finite</span><span class="p">())</span>
    <span class="n">skew</span> <span class="o">=</span> <span class="n">valid</span><span class="o">.</span><span class="n">skew</span><span class="p">()</span>
    <span class="c1"># Pearson Kurtosis, see here: https://en.wikipedia.org/wiki/D%27Agostino%27s_K-squared_test</span>
    <span class="n">kur</span> <span class="o">=</span> <span class="n">valid</span><span class="o">.</span><span class="n">kurtosis</span><span class="p">(</span><span class="n">fisher</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">skew</span><span class="o">.</span><span class="n">register_plugin</span><span class="p">(</span>
        <span class="n">lib</span><span class="o">=</span><span class="n">_lib</span><span class="p">,</span>
        <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;pl_normal_test&quot;</span><span class="p">,</span>
        <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">kur</span><span class="p">,</span> <span class="n">valid</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">UInt64</span><span class="p">)],</span>
        <span class="n">is_elementwise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">returns_scalar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="polars_ds.stats_ext.StatsExt.rand_int" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">rand_int</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">respect_null</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">use_ref</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Generates random integers uniformly from the range [low, high). Throws an error if low == high
or if low is None and high is None and use_ref_nunique == False.</p>
<p>This treats self as the reference column.</p>
<h5 id="polars_ds.stats_ext.StatsExt.rand_int--parameters">Parameters</h5>
<p>low
    Lower end of random sample. None will be replaced 0.
high
    Higher end of random sample. None will be replaced n_unique of reference.
respect_null
    If true, null in reference column will be null in the new column</p>

          <details class="quote">
            <summary>Source code in <code>polars_ds/stats_ext.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">rand_int</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">low</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">high</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">respect_null</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">use_ref</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates random integers uniformly from the range [low, high). Throws an error if low == high</span>
<span class="sd">    or if low is None and high is None and use_ref_nunique == False.</span>

<span class="sd">    This treats self as the reference column.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    low</span>
<span class="sd">        Lower end of random sample. None will be replaced 0.</span>
<span class="sd">    high</span>
<span class="sd">        Higher end of random sample. None will be replaced n_unique of reference.</span>
<span class="sd">    respect_null</span>
<span class="sd">        If true, null in reference column will be null in the new column</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">low</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">high</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Either low or high must be set.&quot;</span><span class="p">)</span>

    <span class="n">lo</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Int32</span><span class="p">)</span>
    <span class="n">hi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">n_unique</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">UInt32</span><span class="p">)</span> <span class="k">if</span> <span class="n">high</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">high</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Int32</span><span class="p">)</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">respect_null</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Boolean</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">register_plugin</span><span class="p">(</span>
        <span class="n">lib</span><span class="o">=</span><span class="n">_lib</span><span class="p">,</span>
        <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;pl_rand_int&quot;</span><span class="p">,</span>
        <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">lo</span><span class="p">,</span> <span class="n">hi</span><span class="p">,</span> <span class="n">resp</span><span class="p">],</span>
        <span class="n">is_elementwise</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">returns_scalar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="polars_ds.stats_ext.StatsExt.rand_str" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">rand_str</span><span class="p">(</span><span class="n">min_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">respect_null</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Creates self.len() many random strings with alpha-numerical values. Unfortunately that
means this currently only generates strings satisfying [0-9a-zA-Z]. The string's
length will also be uniformly.</p>
<p>This treats self as the reference column.</p>
<h5 id="polars_ds.stats_ext.StatsExt.rand_str--parameters">Parameters</h5>
<p>min_size
    The minimum length of the string to be generated. The length of the string will be
    uniformly generated in [min_size, max_size), except when min_size = max_size, in
    which case only fixed length strings will be generated.
max_size
    The maximum length of the string to be generated.
respect_null
    If true, null in reference column will be null in the new column</p>

          <details class="quote">
            <summary>Source code in <code>polars_ds/stats_ext.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">rand_str</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">min_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">max_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">respect_null</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates self.len() many random strings with alpha-numerical values. Unfortunately that</span>
<span class="sd">    means this currently only generates strings satisfying [0-9a-zA-Z]. The string&#39;s</span>
<span class="sd">    length will also be uniformly.</span>

<span class="sd">    This treats self as the reference column.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    min_size</span>
<span class="sd">        The minimum length of the string to be generated. The length of the string will be</span>
<span class="sd">        uniformly generated in [min_size, max_size), except when min_size = max_size, in</span>
<span class="sd">        which case only fixed length strings will be generated.</span>
<span class="sd">    max_size</span>
<span class="sd">        The maximum length of the string to be generated.</span>
<span class="sd">    respect_null</span>
<span class="sd">        If true, null in reference column will be null in the new column</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">max_size</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input `max_size` must be positive.&quot;</span><span class="p">)</span>

    <span class="n">min_s</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">min_size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">UInt32</span><span class="p">)</span>
    <span class="n">max_s</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">max_size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">UInt32</span><span class="p">)</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">respect_null</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Boolean</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">register_plugin</span><span class="p">(</span>
        <span class="n">lib</span><span class="o">=</span><span class="n">_lib</span><span class="p">,</span>
        <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;pl_sample_alphanumeric&quot;</span><span class="p">,</span>
        <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">min_s</span><span class="p">,</span> <span class="n">max_s</span><span class="p">,</span> <span class="n">resp</span><span class="p">],</span>
        <span class="n">is_elementwise</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">returns_scalar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="polars_ds.stats_ext.StatsExt.sample_binomial" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">sample_binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">respect_null</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Creates self.len() many random points sampled from a uniform binomial with n and p.</p>
<p>This treats self as the reference column.</p>
<h5 id="polars_ds.stats_ext.StatsExt.sample_binomial--parameters">Parameters</h5>
<p>n
    n in a binomial distribution
p
    p in a binomial distribution
respect_null
    If true, null in reference column will be null in the new column</p>

          <details class="quote">
            <summary>Source code in <code>polars_ds/stats_ext.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">sample_binomial</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">respect_null</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates self.len() many random points sampled from a uniform binomial with n and p.</span>

<span class="sd">    This treats self as the reference column.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    n</span>
<span class="sd">        n in a binomial distribution</span>
<span class="sd">    p</span>
<span class="sd">        p in a binomial distribution</span>
<span class="sd">    respect_null</span>
<span class="sd">        If true, null in reference column will be null in the new column</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">nn</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">UInt64</span><span class="p">)</span>
    <span class="n">pp</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Float64</span><span class="p">)</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">respect_null</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Boolean</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">register_plugin</span><span class="p">(</span>
        <span class="n">lib</span><span class="o">=</span><span class="n">_lib</span><span class="p">,</span>
        <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;pl_sample_binomial&quot;</span><span class="p">,</span>
        <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">nn</span><span class="p">,</span> <span class="n">pp</span><span class="p">,</span> <span class="n">resp</span><span class="p">],</span>
        <span class="n">is_elementwise</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">returns_scalar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="polars_ds.stats_ext.StatsExt.sample_exp" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">sample_exp</span><span class="p">(</span><span class="n">lam</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">respect_null</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Creates self.len() many random points sampled from a exponential distribution with n and p.</p>
<p>This treats self as the reference column.</p>
<h5 id="polars_ds.stats_ext.StatsExt.sample_exp--parameters">Parameters</h5>
<p>lam
    lambda in a exponential distribution. If none, it will be 1/reference col's mean. Note that if
    lambda &lt; 0 will throw an error and lambda = 0 will only return infinity.
respect_null
    If true, null in reference column will be null in the new column</p>

          <details class="quote">
            <summary>Source code in <code>polars_ds/stats_ext.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">sample_exp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lam</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">respect_null</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates self.len() many random points sampled from a exponential distribution with n and p.</span>

<span class="sd">    This treats self as the reference column.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    lam</span>
<span class="sd">        lambda in a exponential distribution. If none, it will be 1/reference col&#39;s mean. Note that if</span>
<span class="sd">        lambda &lt; 0 will throw an error and lambda = 0 will only return infinity.</span>
<span class="sd">    respect_null</span>
<span class="sd">        If true, null in reference column will be null in the new column</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">lamb</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="k">if</span> <span class="n">lam</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Float64</span><span class="p">)</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">respect_null</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Boolean</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">register_plugin</span><span class="p">(</span>
        <span class="n">lib</span><span class="o">=</span><span class="n">_lib</span><span class="p">,</span>
        <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;pl_sample_exp&quot;</span><span class="p">,</span>
        <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">lamb</span><span class="p">,</span> <span class="n">resp</span><span class="p">],</span>
        <span class="n">is_elementwise</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">returns_scalar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="polars_ds.stats_ext.StatsExt.sample_normal" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">sample_normal</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">std</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">respect_null</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Creates self.len() many random points sampled from a normal distribution with the given
mean and std.</p>
<p>This treats self as the reference column.</p>
<h5 id="polars_ds.stats_ext.StatsExt.sample_normal--parameters">Parameters</h5>
<p>mean
    Mean of the normal distribution. If none, use reference col's mean.
std
    Std of the normal distribution. If none, use reference col's std.
respect_null
    If true, null in reference column will be null in the new column</p>

          <details class="quote">
            <summary>Source code in <code>polars_ds/stats_ext.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">sample_normal</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">std</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">respect_null</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates self.len() many random points sampled from a normal distribution with the given</span>
<span class="sd">    mean and std.</span>

<span class="sd">    This treats self as the reference column.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mean</span>
<span class="sd">        Mean of the normal distribution. If none, use reference col&#39;s mean.</span>
<span class="sd">    std</span>
<span class="sd">        Std of the normal distribution. If none, use reference col&#39;s std.</span>
<span class="sd">    respect_null</span>
<span class="sd">        If true, null in reference column will be null in the new column</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">me</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="k">if</span> <span class="n">mean</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Float64</span><span class="p">)</span>
    <span class="n">st</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="k">if</span> <span class="n">std</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">std</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Float64</span><span class="p">)</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">respect_null</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Boolean</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">register_plugin</span><span class="p">(</span>
        <span class="n">lib</span><span class="o">=</span><span class="n">_lib</span><span class="p">,</span>
        <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;pl_sample_normal&quot;</span><span class="p">,</span>
        <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">me</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span> <span class="n">resp</span><span class="p">],</span>
        <span class="n">is_elementwise</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">returns_scalar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="polars_ds.stats_ext.StatsExt.sample_uniform" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">sample_uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">respect_null</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Creates self.len() many random points sampled from a uniform distribution within [low, high).
This will throw an error if low == high.</p>
<p>This treats self as the reference column.</p>
<h5 id="polars_ds.stats_ext.StatsExt.sample_uniform--parameters">Parameters</h5>
<p>low
    Lower end of random sample. If none, use reference col's min.
high
    Higher end of random sample. If none, use reference col's max.
respect_null
    If true, null in reference column will be null in the new column</p>

          <details class="quote">
            <summary>Source code in <code>polars_ds/stats_ext.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">sample_uniform</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">low</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">high</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">respect_null</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates self.len() many random points sampled from a uniform distribution within [low, high).</span>
<span class="sd">    This will throw an error if low == high.</span>

<span class="sd">    This treats self as the reference column.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    low</span>
<span class="sd">        Lower end of random sample. If none, use reference col&#39;s min.</span>
<span class="sd">    high</span>
<span class="sd">        Higher end of random sample. If none, use reference col&#39;s max.</span>
<span class="sd">    respect_null</span>
<span class="sd">        If true, null in reference column will be null in the new column</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">lo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="k">if</span> <span class="n">low</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Float64</span><span class="p">)</span>
    <span class="n">hi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="k">if</span> <span class="n">high</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">high</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Float64</span><span class="p">)</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">respect_null</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Boolean</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">register_plugin</span><span class="p">(</span>
        <span class="n">lib</span><span class="o">=</span><span class="n">_lib</span><span class="p">,</span>
        <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;pl_sample_uniform&quot;</span><span class="p">,</span>
        <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">lo</span><span class="p">,</span> <span class="n">hi</span><span class="p">,</span> <span class="n">resp</span><span class="p">],</span>
        <span class="n">is_elementwise</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">returns_scalar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="polars_ds.stats_ext.StatsExt.ttest_1samp" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">ttest_1samp</span><span class="p">(</span><span class="n">pop_mean</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Performs a standard 1 sample t test using reference column and expected mean. This function
sanitizes the self column first. The df is the count of valid values.</p>
<h5 id="polars_ds.stats_ext.StatsExt.ttest_1samp--parameters">Parameters</h5>
<p>pop_mean
    The expected population mean in the hypothesis test
alternative
    One of "two-sided", "less" or "greater"</p>

          <details class="quote">
            <summary>Source code in <code>polars_ds/stats_ext.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">ttest_1samp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop_mean</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">alternative</span><span class="p">:</span> <span class="n">Alternative</span> <span class="o">=</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs a standard 1 sample t test using reference column and expected mean. This function</span>
<span class="sd">    sanitizes the self column first. The df is the count of valid values.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    pop_mean</span>
<span class="sd">        The expected population mean in the hypothesis test</span>
<span class="sd">    alternative</span>
<span class="sd">        One of &quot;two-sided&quot;, &quot;less&quot; or &quot;greater&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">s1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">is_finite</span><span class="p">())</span>
    <span class="n">sm</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">pm</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">pop_mean</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Float64</span><span class="p">)</span>
    <span class="n">var</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
    <span class="n">cnt</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">UInt64</span><span class="p">)</span>
    <span class="n">alt</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">alternative</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Utf8</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sm</span><span class="o">.</span><span class="n">register_plugin</span><span class="p">(</span>
        <span class="n">lib</span><span class="o">=</span><span class="n">_lib</span><span class="p">,</span>
        <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;pl_ttest_1samp&quot;</span><span class="p">,</span>
        <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">pm</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">cnt</span><span class="p">,</span> <span class="n">alt</span><span class="p">],</span>
        <span class="n">is_elementwise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">returns_scalar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="polars_ds.stats_ext.StatsExt.ttest_ind" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">ttest_ind</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">,</span> <span class="n">equal_var</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Performs 2 sample student's t test or Welch's t test. Functionality-wise this is
equivalent to SciPy's ttest_ind, with fewer options. The result is not exact but
within 1e-10 precision from SciPy's result.</p>
<p>In the case of student's t test, the data is assumed to have no nulls, and n = self._expr.count()
is used to compute the statistic. Note self._expr.count() only counts non-null elements after polars 0.20.
The df will be 2n - 2. As a result, nulls might cause problems.</p>
<p>In the case of Welch's t test, data will be sanitized (nulls, NaNs, Infs will be dropped
before the test), and df will be counted based on the length of sanitized data.</p>
<h5 id="polars_ds.stats_ext.StatsExt.ttest_ind--parameters">Parameters</h5>
<p>other
    The other expression
alternative
    One of "two-sided", "less" or "greater"
equal_var
    If true, perform standard student t 2 sample test. Otherwise, perform Welch's
    t test.</p>

          <details class="quote">
            <summary>Source code in <code>polars_ds/stats_ext.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">ttest_ind</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">,</span> <span class="n">alternative</span><span class="p">:</span> <span class="n">Alternative</span> <span class="o">=</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">,</span> <span class="n">equal_var</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs 2 sample student&#39;s t test or Welch&#39;s t test. Functionality-wise this is</span>
<span class="sd">    equivalent to SciPy&#39;s ttest_ind, with fewer options. The result is not exact but</span>
<span class="sd">    within 1e-10 precision from SciPy&#39;s result.</span>

<span class="sd">    In the case of student&#39;s t test, the data is assumed to have no nulls, and n = self._expr.count()</span>
<span class="sd">    is used to compute the statistic. Note self._expr.count() only counts non-null elements after polars 0.20.</span>
<span class="sd">    The df will be 2n - 2. As a result, nulls might cause problems.</span>

<span class="sd">    In the case of Welch&#39;s t test, data will be sanitized (nulls, NaNs, Infs will be dropped</span>
<span class="sd">    before the test), and df will be counted based on the length of sanitized data.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    other</span>
<span class="sd">        The other expression</span>
<span class="sd">    alternative</span>
<span class="sd">        One of &quot;two-sided&quot;, &quot;less&quot; or &quot;greater&quot;</span>
<span class="sd">    equal_var</span>
<span class="sd">        If true, perform standard student t 2 sample test. Otherwise, perform Welch&#39;s</span>
<span class="sd">        t test.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">equal_var</span><span class="p">:</span>
        <span class="n">m1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">m2</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">v1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
        <span class="n">v2</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
        <span class="n">cnt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">UInt64</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">m1</span><span class="o">.</span><span class="n">register_plugin</span><span class="p">(</span>
            <span class="n">lib</span><span class="o">=</span><span class="n">_lib</span><span class="p">,</span>
            <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;pl_ttest_2samp&quot;</span><span class="p">,</span>
            <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">m2</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">cnt</span><span class="p">,</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">alternative</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Utf8</span><span class="p">)],</span>
            <span class="n">is_elementwise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">returns_scalar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">s1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_expr</span><span class="o">.</span><span class="n">is_finite</span><span class="p">())</span>
        <span class="n">s2</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">is_finite</span><span class="p">())</span>
        <span class="n">m1</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">m2</span> <span class="o">=</span> <span class="n">s2</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">v1</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
        <span class="n">v2</span> <span class="o">=</span> <span class="n">s2</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
        <span class="n">n1</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">UInt64</span><span class="p">)</span>
        <span class="n">n2</span> <span class="o">=</span> <span class="n">s2</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">UInt64</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">m1</span><span class="o">.</span><span class="n">register_plugin</span><span class="p">(</span>
            <span class="n">lib</span><span class="o">=</span><span class="n">_lib</span><span class="p">,</span>
            <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;pl_welch_t&quot;</span><span class="p">,</span>
            <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">m2</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">alternative</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Utf8</span><span class="p">)],</span>
            <span class="n">is_elementwise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">returns_scalar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.d7c377c4.min.js"></script>
      
    
  </body>
</html>